/* eslint-disable @typescript-eslint/no-unsafe-assignment */
/* eslint-disable @typescript-eslint/no-unsafe-call */
/* eslint-disable @typescript-eslint/no-unsafe-argument */
/* eslint-disable @typescript-eslint/no-unsafe-member-access */
import { Injectable, Logger } from '@nestjs/common';
import { InjectModel } from '@nestjs/mongoose';
import { Model, Types } from 'mongoose';
import * as bcrypt from 'bcrypt';
import {
  User,
  UserDocument,
  UserRole,
  UserStatus,
  LoginMethod,
} from '../schemas/user.schema';
import {
  Employee,
  EmployeeDocument,
} from '../../employees/schemas/employee.schema';
import {
  Department,
  DepartmentDocument,
} from '../../organization/departments/schemas/department.schema';
import {
  Position,
  PositionDocument,
} from '../../organization/positions/schemas/position.schema';
import {
  Grade,
  GradeDocument,
} from '../../organization/grades/schemas/grade.schema';
import {
  ContractType,
  EmploymentStatus,
  SystemRole,
} from '../../../common/enums';
import { EmployeeNumberService } from '../../employees/employee-number.service';

interface EmployeeHierarchyData {
  username: string;
  email: string;
  password: string;
  role: UserRole;
  employeeData: Partial<Employee>;
  departmentCode: string;
  positionCode: string;
  gradeCode: string;
  reportsToUsername?: string;
}

@Injectable()
export class OrganizationSeederService {
  private readonly logger = new Logger(OrganizationSeederService.name);
  private userMap = new Map<string, Types.ObjectId>();
  private employeeMap = new Map<string, Types.ObjectId>();

  constructor(
    @InjectModel(User.name) private userModel: Model<UserDocument>,
    @InjectModel(Employee.name) private employeeModel: Model<EmployeeDocument>,
    @InjectModel(Department.name)
    private departmentModel: Model<DepartmentDocument>,
    @InjectModel(Position.name) private positionModel: Model<PositionDocument>,
    @InjectModel(Grade.name) private gradeModel: Model<GradeDocument>,
    private employeeNumberService: EmployeeNumberService,
  ) {}

  private safeGetObjectId(id: any): Types.ObjectId {
    if (id instanceof Types.ObjectId) return id;
    if (typeof id === 'string') return new Types.ObjectId(id);
    if (id && typeof id === 'object') {
      if ('_id' in id) return this.safeGetObjectId(id._id);
      if ('toString' in id && typeof id.toString === 'function') {
        return new Types.ObjectId(id.toString());
      }
    }
    throw new Error(`Cannot convert to ObjectId: ${JSON.stringify(id)}`);
  }

  // ==================== EXECUTIVE MANAGEMENT ====================
  private async createExecutiveManagement() {
    const executives: EmployeeHierarchyData[] = [
      {
        username: 'chief.executive.officer',
        email: 'ceo@sethnnections.mw',
        password: 'CEO123!',
        role: UserRole.SUPER_SUPER_ADMIN,
        departmentCode: 'EXEC',
        positionCode: 'CEO',
        gradeCode: 'CEO',
        employeeData: {
          firstName: 'Super',
          lastName: 'Admin',
          dateOfBirth: new Date('1975-01-01'),
          gender: 'Male',
          nationalId: 'MWI001001001',
          email: 'ceo@sethnnections.mw',
          phoneNumber: '+265888000001',
          employmentDate: new Date('2020-01-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 9000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9000000000001',
          bankBranch: 'Head Office',
          bankBranchCode: 'SBM000',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN000000001',
          pensionNumber: 'MLPF000001',
          socialSecurityNumber: 'SSN000001',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 001, Executive Area, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40001',
          systemRole: SystemRole.SUPER_ADMIN,
        },
      },
      {
        username: 'chief.operations.officer',
        email: 'coo@sethnnections.mw',
        password: 'COO123!',
        role: UserRole.SUPER_ADMIN,
        departmentCode: 'EXEC',
        positionCode: 'COO',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'James',
          lastName: 'Kalonga',
          dateOfBirth: new Date('1977-04-12'),
          gender: 'Male',
          nationalId: 'MWI002001001',
          email: 'coo@sethnnections.mw',
          phoneNumber: '+265888000002',
          employmentDate: new Date('2020-01-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6500000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1014567890123',
          bankBranch: 'Head Office',
          bankBranchCode: 'NBM000',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 456, Executive Area, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40002',
          systemRole: SystemRole.SUPER_ADMIN,
        },
      },
      // ADDING MISSING C-SUITE EXECUTIVES
      {
        username: 'chief.technology.officer.exec',
        email: 'cto.exec@sethnnections.mw',
        password: 'CTO123!',
        role: UserRole.SUPER_ADMIN,
        departmentCode: 'EXEC',
        positionCode: 'CTO',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'David',
          lastName: 'Mwale',
          dateOfBirth: new Date('1976-08-15'),
          gender: 'Male',
          nationalId: 'MWI002001002',
          email: 'cto.exec@sethnnections.mw',
          phoneNumber: '+265888000003',
          employmentDate: new Date('2020-01-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9000000000002',
          bankBranch: 'Head Office',
          bankBranchCode: 'SBM000',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN000000002',
          pensionNumber: 'MLPF000002',
          socialSecurityNumber: 'SSN000002',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 002, Executive Area, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40003',
          systemRole: SystemRole.SUPER_ADMIN,
        },
      },
      {
        username: 'chief.financial.officer.exec',
        email: 'cfo.exec@sethnnections.mw',
        password: 'CFO123!',
        role: UserRole.FINANCE_MANAGER,
        departmentCode: 'EXEC',
        positionCode: 'CFO',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Linda',
          lastName: 'Kumwenda',
          dateOfBirth: new Date('1978-03-22'),
          gender: 'Female',
          nationalId: 'MWI002001003',
          email: 'cfo.exec@sethnnections.mw',
          phoneNumber: '+265888000004',
          employmentDate: new Date('2020-01-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6500000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1014567890124',
          bankBranch: 'Head Office',
          bankBranchCode: 'NBM000',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789013',
          pensionNumber: 'MLPF456790',
          socialSecurityNumber: 'SSN456790',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 457, Executive Area, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40004',
          systemRole: SystemRole.FINANCE_MANAGER,
        },
      },
      {
        username: 'chief.hr.officer.exec',
        email: 'chro.exec@sethnnections.mw',
        password: 'CHRO123!',
        role: UserRole.HR_MANAGER,
        departmentCode: 'EXEC',
        positionCode: 'CHRO',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Grace',
          lastName: 'Banda',
          dateOfBirth: new Date('1979-11-30'),
          gender: 'Female',
          nationalId: 'MWI002001004',
          email: 'chro.exec@sethnnections.mw',
          phoneNumber: '+265888000005',
          employmentDate: new Date('2020-01-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9000000000003',
          bankBranch: 'Head Office',
          bankBranchCode: 'SBM000',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN000000003',
          pensionNumber: 'MLPF000003',
          socialSecurityNumber: 'SSN000003',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 003, Executive Area, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40005',
          systemRole: SystemRole.HR_MANAGER,
        },
      },
    ];

    await this.createEmployeeBatch(executives);
  }
  // ==================== TECHNICAL DEPARTMENT ====================
  private async createTechnicalDepartmentEmployees() {
    const technicalEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'tech.director',
        email: 'tech.director@sethnnections.mw',
        password: 'TechDirector123!',
        role: UserRole.DEPARTMENT_HEAD,
        departmentCode: 'TECH',
        positionCode: 'TECH_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.operations.officer',
        employeeData: {
          firstName: 'Chifundo',
          lastName: 'Banda',
          dateOfBirth: new Date('1979-11-15'),
          gender: 'Male',
          nationalId: 'MWI003001001',
          email: 'tech.director@sethnnections.mw',
          phoneNumber: '+265888000010',
          employmentDate: new Date('2020-02-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9001234567890',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN987654321',
          pensionNumber: 'MLPF654987',
          socialSecurityNumber: 'SSN654987',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 456, Area 43, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40105',
          systemRole: SystemRole.DEPARTMENT_HEAD,
        },
      },
      // Chief Grid Engineer
      {
        username: 'grid.chief.engineer',
        email: 'grid.chief@sethnnections.mw',
        password: 'GridChief123!',
        role: UserRole.MANAGER,
        departmentCode: 'TECH',
        positionCode: 'GRID_CHIEF',
        gradeCode: 'M15',
        reportsToUsername: 'tech.director',
        employeeData: {
          firstName: 'Mphatso',
          lastName: 'Phiri',
          dateOfBirth: new Date('1984-07-22'),
          gender: 'Male',
          nationalId: 'MWI004001001',
          email: 'grid.chief@sethnnections.mw',
          phoneNumber: '+265888000011',
          employmentDate: new Date('2020-04-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'FDH Bank',
          bankAccountNumber: '5001234567890',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'FDH001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789123456',
          pensionNumber: 'MLPF789456',
          socialSecurityNumber: 'SSN789456',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 789, Area 47, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40106',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Principal Engineer
      {
        username: 'principal.engineer.grid',
        email: 'principal.engineer@sethnnections.mw',
        password: 'PrincipalEng123!',
        role: UserRole.MANAGER,
        departmentCode: 'TECH',
        positionCode: 'PRIN_ENG',
        gradeCode: 'M13',
        reportsToUsername: 'grid.chief.engineer',
        employeeData: {
          firstName: 'Tionge',
          lastName: 'Kumwenda',
          dateOfBirth: new Date('1986-03-10'),
          gender: 'Female',
          nationalId: 'MWI005001001',
          email: 'principal.engineer@sethnnections.mw',
          phoneNumber: '+265888000012',
          employmentDate: new Date('2020-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1001234567890',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789123',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 123, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40107',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Maintenance Engineer
      {
        username: 'maintenance.engineer.1',
        email: 'maintenance.engineer1@sethnnections.mw',
        password: 'MaintEng123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'TECH',
        positionCode: 'MAINT_ENG',
        gradeCode: 'M11',
        reportsToUsername: 'principal.engineer.grid',
        employeeData: {
          firstName: 'Dalitso',
          lastName: 'Mkandawire',
          dateOfBirth: new Date('1988-09-15'),
          gender: 'Male',
          nationalId: 'MWI006001001',
          email: 'maintenance.engineer1@sethnnections.mw',
          phoneNumber: '+265888000013',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9002345678901',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 234, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40108',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Network Control Engineer
      {
        username: 'network.control.engineer',
        email: 'network.engineer@sethnnections.mw',
        password: 'NetworkEng123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'TECH',
        positionCode: 'NET_ENG',
        gradeCode: 'M10',
        reportsToUsername: 'maintenance.engineer.1',
        employeeData: {
          firstName: 'Grace',
          lastName: 'Jere',
          dateOfBirth: new Date('1990-12-20'),
          gender: 'Female',
          nationalId: 'MWI007001001',
          email: 'network.engineer@sethnnections.mw',
          phoneNumber: '+265888000014',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1002345678901',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 345, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40109',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Field Supervisor
      {
        username: 'field.supervisor.north',
        email: 'field.supervisor.north@sethnnections.mw',
        password: 'FieldSuper123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'TECH',
        positionCode: 'FIELD_SUP',
        gradeCode: 'M9',
        reportsToUsername: 'network.control.engineer',
        employeeData: {
          firstName: 'Tawonga',
          lastName: 'Mwale',
          dateOfBirth: new Date('1988-09-30'),
          gender: 'Female',
          nationalId: 'MWI008001001',
          email: 'field.supervisor.north@sethnnections.mw',
          phoneNumber: '+265888000015',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1003456789012',
          bankBranch: 'Area 2 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 456, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40110',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Substation Technician
      {
        username: 'substation.tech.1',
        email: 'substation.tech1@sethnnections.mw',
        password: 'SubTech123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'TECH',
        positionCode: 'SUB_TECH',
        gradeCode: 'M8',
        reportsToUsername: 'field.supervisor.north',
        employeeData: {
          firstName: 'Mike',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1991-04-15'),
          gender: 'Male',
          nationalId: 'MWI009001001',
          email: 'substation.tech1@sethnnections.mw',
          phoneNumber: '+265888000016',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9003456789012',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 567, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40111',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Senior Linesman
      {
        username: 'senior.linesman.1',
        email: 'senior.linesman1@sethnnections.mw',
        password: 'SeniorLines123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'TECH',
        positionCode: 'SEN_LINES',
        gradeCode: 'M6',
        reportsToUsername: 'field.supervisor.north',
        employeeData: {
          firstName: 'Robert',
          lastName: 'Msiska',
          dateOfBirth: new Date('1990-08-25'),
          gender: 'Male',
          nationalId: 'MWI010001001',
          email: 'senior.linesman1@sethnnections.mw',
          phoneNumber: '+265888000017',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1004567890123',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 678, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40112',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Linesman
      {
        username: 'linesman.employee.1',
        email: 'linesman.employee1@sethnnections.mw',
        password: 'Linesman123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'TECH',
        positionCode: 'LINESMAN',
        gradeCode: 'M5',
        reportsToUsername: 'senior.linesman.1',
        employeeData: {
          firstName: 'Joseph',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1992-11-08'),
          gender: 'Male',
          nationalId: 'MWI011001001',
          email: 'linesman.employee1@sethnnections.mw',
          phoneNumber: '+265888000018',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 720000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1005678901234',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 789, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40113',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Linesman Apprentice
      {
        username: 'linesman.apprentice.1',
        email: 'linesman.apprentice1@sethnnections.mw',
        password: 'Apprentice123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'TECH',
        positionCode: 'LINES_APP',
        gradeCode: 'M3',
        reportsToUsername: 'senior.linesman.1',
        employeeData: {
          firstName: 'Peter',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1998-05-20'),
          gender: 'Male',
          nationalId: 'MWI012001001',
          email: 'linesman.apprentice1@sethnnections.mw',
          phoneNumber: '+265888000019',
          employmentDate: new Date('2023-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9004567890123',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 890, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40114',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(technicalEmployees);
  }

  // ==================== COMMERCIAL DEPARTMENT - COMPLETE ====================
  private async createCommercialDepartmentEmployees() {
    const commercialEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'comm.director',
        email: 'comm.director@sethnnections.mw',
        password: 'CommDirector123!',
        role: UserRole.DEPARTMENT_HEAD,
        departmentCode: 'COMM',
        positionCode: 'COMM_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.operations.officer',
        employeeData: {
          firstName: 'Chimwemwe',
          lastName: 'Kamoto',
          dateOfBirth: new Date('1981-08-20'),
          gender: 'Female',
          nationalId: 'MWI013001001',
          email: 'comm.director@sethnnections.mw',
          phoneNumber: '+265888000020',
          employmentDate: new Date('2020-02-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9005678901234',
          bankBranch: 'Capital City Branch',
          bankBranchCode: 'SBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 901, Area 18, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40115',
          systemRole: SystemRole.DEPARTMENT_HEAD,
        },
      },
      {
        username: 'chief.commercial.officer',
        email: 'cco@sethnnections.mw',
        password: 'CCO123!',
        role: UserRole.MANAGER,
        departmentCode: 'COMM',
        positionCode: 'CCO',
        gradeCode: 'M15',
        reportsToUsername: 'comm.director',
        employeeData: {
          firstName: 'Andrew',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1983-12-10'),
          gender: 'Male',
          nationalId: 'MWI014001001',
          email: 'cco@sethnnections.mw',
          phoneNumber: '+265888000021',
          employmentDate: new Date('2020-04-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1006789012345',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM005',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 012, Area 6, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40116',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Senior Manager (Key Accounts)
      {
        username: 'senior.manager.keyaccounts',
        email: 'senior.manager.accounts@sethnnections.mw',
        password: 'SeniorMgr123!',
        role: UserRole.MANAGER,
        departmentCode: 'COMM',
        positionCode: 'SEN_MGR_KEY',
        gradeCode: 'M13',
        reportsToUsername: 'chief.commercial.officer',
        employeeData: {
          firstName: 'Grace',
          lastName: 'Banda',
          dateOfBirth: new Date('1985-06-15'),
          gender: 'Female',
          nationalId: 'MWI014001002',
          email: 'senior.manager.accounts@sethnnections.mw',
          phoneNumber: '+265888000022',
          employmentDate: new Date('2020-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9006789012345',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 123, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40117',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Commercial Manager (Region)
      {
        username: 'commercial.manager.region',
        email: 'commercial.manager@sethnnections.mw',
        password: 'CommMgr123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'COMM',
        positionCode: 'COMM_MGR_REG',
        gradeCode: 'M11',
        reportsToUsername: 'senior.manager.keyaccounts',
        employeeData: {
          firstName: 'Mike',
          lastName: 'Jere',
          dateOfBirth: new Date('1987-09-25'),
          gender: 'Male',
          nationalId: 'MWI014001003',
          email: 'commercial.manager@sethnnections.mw',
          phoneNumber: '+265888000023',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1007890123456',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 234, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40118',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Tariffs & Regulations Analyst
      {
        username: 'tariffs.analyst',
        email: 'tariffs.analyst@sethnnections.mw',
        password: 'TariffAnal123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'COMM',
        positionCode: 'TARIFF_ANAL',
        gradeCode: 'M10',
        reportsToUsername: 'commercial.manager.region',
        employeeData: {
          firstName: 'Sarah',
          lastName: 'Phiri',
          dateOfBirth: new Date('1990-03-12'),
          gender: 'Female',
          nationalId: 'MWI014001004',
          email: 'tariffs.analyst@sethnnections.mw',
          phoneNumber: '+265888000024',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9007890123456',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 345, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40119',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // New Connections Officer
      {
        username: 'new.connections.officer',
        email: 'new.connections@sethnnections.mw',
        password: 'NewConn123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'COMM',
        positionCode: 'NEW_CONN',
        gradeCode: 'M9',
        reportsToUsername: 'commercial.manager.region',
        employeeData: {
          firstName: 'David',
          lastName: 'Mkandawire',
          dateOfBirth: new Date('1988-11-30'),
          gender: 'Male',
          nationalId: 'MWI014001005',
          email: 'new.connections@sethnnections.mw',
          phoneNumber: '+265888000025',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1008901234567',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 456, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40120',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Revenue Protection Officer
      {
        username: 'revenue.protection.officer',
        email: 'revenue.protection@sethnnections.mw',
        password: 'RevenueProt123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'COMM',
        positionCode: 'REV_PROTECT',
        gradeCode: 'M8',
        reportsToUsername: 'new.connections.officer',
        employeeData: {
          firstName: 'John',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1991-07-15'),
          gender: 'Male',
          nationalId: 'MWI014001006',
          email: 'revenue.protection@sethnnections.mw',
          phoneNumber: '+265888000026',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9008901234567',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 567, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40121',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Customer Service Representative
      {
        username: 'customer.service.rep1',
        email: 'cs.rep1@sethnnections.mw',
        password: 'CSRep123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'COMM',
        positionCode: 'CS_REP',
        gradeCode: 'M7',
        reportsToUsername: 'new.connections.officer',
        employeeData: {
          firstName: 'Alice',
          lastName: 'Msiska',
          dateOfBirth: new Date('1992-04-25'),
          gender: 'Female',
          nationalId: 'MWI014001007',
          email: 'cs.rep1@sethnnections.mw',
          phoneNumber: '+265888000027',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1009012345678',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 678, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40122',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Billing Clerk
      {
        username: 'billing.clerk1',
        email: 'billing.clerk1@sethnnections.mw',
        password: 'BillingClerk123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'COMM',
        positionCode: 'BILL_CLERK',
        gradeCode: 'M6',
        reportsToUsername: 'new.connections.officer',
        employeeData: {
          firstName: 'Peter',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1993-10-08'),
          gender: 'Male',
          nationalId: 'MWI014001008',
          email: 'billing.clerk1@sethnnections.mw',
          phoneNumber: '+265888000028',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1010123456789',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 789, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40123',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Meter Reader
      {
        username: 'meter.reader1',
        email: 'meter.reader1@sethnnections.mw',
        password: 'MeterReader123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'COMM',
        positionCode: 'METER_READER',
        gradeCode: 'M4',
        reportsToUsername: 'billing.clerk1',
        employeeData: {
          firstName: 'James',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1995-12-20'),
          gender: 'Male',
          nationalId: 'MWI014001009',
          email: 'meter.reader1@sethnnections.mw',
          phoneNumber: '+265888000029',
          employmentDate: new Date('2023-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 600000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9011234567890',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 890, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40124',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(commercialEmployees);
  }

  // ==================== FINANCE DEPARTMENT - COMPLETE ====================
  private async createFinanceDepartmentEmployees() {
    const financeEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'finance.director',
        email: 'finance.director@sethnnections.mw',
        password: 'FinanceDir123!',
        role: UserRole.FINANCE_MANAGER,
        departmentCode: 'FIN',
        positionCode: 'FIN_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Thokozani',
          lastName: 'Nyirenda',
          dateOfBirth: new Date('1982-05-15'),
          gender: 'Male',
          nationalId: 'MWI015001001',
          email: 'finance.director@sethnnections.mw',
          phoneNumber: '+265888000030',
          employmentDate: new Date('2020-02-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1007890123456',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 234, Area 11, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40125',
          systemRole: SystemRole.FINANCE_MANAGER,
        },
      },
      // Chief Financial Officer
      {
        username: 'chief.financial.officer',
        email: 'cfo@sethnnections.mw',
        password: 'CFO123!',
        role: UserRole.FINANCE_MANAGER,
        departmentCode: 'FIN',
        positionCode: 'CFO',
        gradeCode: 'M15',
        reportsToUsername: 'finance.director',
        employeeData: {
          firstName: 'Linda',
          lastName: 'Kumwenda',
          dateOfBirth: new Date('1984-08-22'),
          gender: 'Female',
          nationalId: 'MWI015001002',
          email: 'cfo@sethnnections.mw',
          phoneNumber: '+265888000031',
          employmentDate: new Date('2020-04-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9012345678901',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 345, Area 7, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40126',
          systemRole: SystemRole.FINANCE_MANAGER,
        },
      },
      // Finance Manager
      {
        username: 'finance.manager',
        email: 'finance.manager@sethnnections.mw',
        password: 'FinMgr123!',
        role: UserRole.MANAGER,
        departmentCode: 'FIN',
        positionCode: 'FIN_MGR',
        gradeCode: 'M13',
        reportsToUsername: 'chief.financial.officer',
        employeeData: {
          firstName: 'Robert',
          lastName: 'Phiri',
          dateOfBirth: new Date('1986-03-10'),
          gender: 'Male',
          nationalId: 'MWI015001003',
          email: 'finance.manager@sethnnections.mw',
          phoneNumber: '+265888000032',
          employmentDate: new Date('2020-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1012345678901',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 456, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40127',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Senior Accountant
      {
        username: 'senior.accountant',
        email: 'senior.accountant@sethnnections.mw',
        password: 'SeniorAcc123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'FIN',
        positionCode: 'SEN_ACC',
        gradeCode: 'M11',
        reportsToUsername: 'finance.manager',
        employeeData: {
          firstName: 'Mary',
          lastName: 'Jere',
          dateOfBirth: new Date('1988-09-15'),
          gender: 'Female',
          nationalId: 'MWI015001004',
          email: 'senior.accountant@sethnnections.mw',
          phoneNumber: '+265888000033',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9023456789012',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 567, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40128',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Financial Analyst
      {
        username: 'financial.analyst',
        email: 'financial.analyst@sethnnections.mw',
        password: 'FinAnal123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'FIN',
        positionCode: 'FIN_ANAL',
        gradeCode: 'M10',
        reportsToUsername: 'senior.accountant',
        employeeData: {
          firstName: 'Thomas',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1990-12-20'),
          gender: 'Male',
          nationalId: 'MWI015001005',
          email: 'financial.analyst@sethnnections.mw',
          phoneNumber: '+265888000034',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1023456789012',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 678, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40129',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Internal Auditor
      {
        username: 'internal.auditor',
        email: 'internal.auditor@sethnnections.mw',
        password: 'InternalAudit123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'FIN',
        positionCode: 'INT_AUDIT',
        gradeCode: 'M9',
        reportsToUsername: 'senior.accountant',
        employeeData: {
          firstName: 'Patricia',
          lastName: 'Msiska',
          dateOfBirth: new Date('1988-09-30'),
          gender: 'Female',
          nationalId: 'MWI015001006',
          email: 'internal.auditor@sethnnections.mw',
          phoneNumber: '+265888000035',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1034567890123',
          bankBranch: 'Area 2 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 789, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40130',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Payroll Administrator
      {
        username: 'payroll.admin',
        email: 'payroll.admin@sethnnections.mw',
        password: 'PayrollAdmin123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'FIN',
        positionCode: 'PAYROLL_ADM',
        gradeCode: 'M8',
        reportsToUsername: 'internal.auditor',
        employeeData: {
          firstName: 'Brian',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1991-04-15'),
          gender: 'Male',
          nationalId: 'MWI015001007',
          email: 'payroll.admin@sethnnections.mw',
          phoneNumber: '+265888000036',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9034567890123',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 890, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40131',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Accounts Receivable Clerk
      {
        username: 'accounts.receivable.clerk',
        email: 'ar.clerk@sethnnections.mw',
        password: 'ARClerk123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'FIN',
        positionCode: 'AR_CLERK',
        gradeCode: 'M7',
        reportsToUsername: 'internal.auditor',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1992-11-08'),
          gender: 'Female',
          nationalId: 'MWI015001008',
          email: 'ar.clerk@sethnnections.mw',
          phoneNumber: '+265888000037',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1045678901234',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 901, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40132',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Accounts Payable Clerk
      {
        username: 'accounts.payable.clerk',
        email: 'ap.clerk@sethnnections.mw',
        password: 'APClerk123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'FIN',
        positionCode: 'AP_CLERK',
        gradeCode: 'M6',
        reportsToUsername: 'internal.auditor',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Mwale',
          dateOfBirth: new Date('1993-08-25'),
          gender: 'Male',
          nationalId: 'MWI015001009',
          email: 'ap.clerk@sethnnections.mw',
          phoneNumber: '+265888000038',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1056789012345',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 012, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40133',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Cashier
      {
        username: 'cashier1',
        email: 'cashier1@sethnnections.mw',
        password: 'Cashier123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'FIN',
        positionCode: 'CASHIER',
        gradeCode: 'M4',
        reportsToUsername: 'accounts.payable.clerk',
        employeeData: {
          firstName: 'Rachel',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1995-05-20'),
          gender: 'Female',
          nationalId: 'MWI015001010',
          email: 'cashier1@sethnnections.mw',
          phoneNumber: '+265888000039',
          employmentDate: new Date('2023-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 600000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9045678901234',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 123, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40134',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(financeEmployees);
  }

  // ==================== IT DEPARTMENT - COMPLETE ====================
  private async createItDepartmentEmployees() {
    const itEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'it.director',
        email: 'it.director@sethnnections.mw',
        password: 'ITDirector123!',
        role: UserRole.DEPARTMENT_HEAD,
        departmentCode: 'IT',
        positionCode: 'IT_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Mwale',
          dateOfBirth: new Date('1980-03-15'),
          gender: 'Male',
          nationalId: 'MWI016001001',
          email: 'it.director@sethnnections.mw',
          phoneNumber: '+265888000040',
          employmentDate: new Date('2020-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1013456789012',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 234, Area 5, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40135',
          systemRole: SystemRole.DEPARTMENT_HEAD,
        },
      },
      // Chief Technology Officer
      {
        username: 'chief.technology.officer',
        email: 'cto@sethnnections.mw',
        password: 'CTO123!',
        role: UserRole.MANAGER,
        departmentCode: 'IT',
        positionCode: 'CTO',
        gradeCode: 'M15',
        reportsToUsername: 'it.director',
        employeeData: {
          firstName: 'Sarah',
          lastName: 'Banda',
          dateOfBirth: new Date('1982-07-20'),
          gender: 'Female',
          nationalId: 'MWI016001002',
          email: 'cto@sethnnections.mw',
          phoneNumber: '+265888000041',
          employmentDate: new Date('2020-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9056789012345',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 345, Area 8, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40136',
          systemRole: SystemRole.MANAGER,
        },
      },
      // IT Manager
      {
        username: 'it.manager',
        email: 'it.manager@sethnnections.mw',
        password: 'ITMgr123!',
        role: UserRole.MANAGER,
        departmentCode: 'IT',
        positionCode: 'IT_MGR',
        gradeCode: 'M13',
        reportsToUsername: 'chief.technology.officer',
        employeeData: {
          firstName: 'Mike',
          lastName: 'Phiri',
          dateOfBirth: new Date('1984-11-12'),
          gender: 'Male',
          nationalId: 'MWI016001003',
          email: 'it.manager@sethnnections.mw',
          phoneNumber: '+265888000042',
          employmentDate: new Date('2020-05-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1067890123456',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 456, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40137',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Systems Analyst / Programmer
      {
        username: 'systems.analyst',
        email: 'systems.analyst@sethnnections.mw',
        password: 'SysAnalyst123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'IT',
        positionCode: 'SYS_ANAL',
        gradeCode: 'M11',
        reportsToUsername: 'it.manager',
        employeeData: {
          firstName: 'Grace',
          lastName: 'Jere',
          dateOfBirth: new Date('1986-04-25'),
          gender: 'Female',
          nationalId: 'MWI016001004',
          email: 'systems.analyst@sethnnections.mw',
          phoneNumber: '+265888000043',
          employmentDate: new Date('2021-02-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9067890123456',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 567, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40138',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Business Analyst
      {
        username: 'business.analyst',
        email: 'business.analyst@sethnnections.mw',
        password: 'BusAnalyst123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'IT',
        positionCode: 'BUS_ANAL',
        gradeCode: 'M10',
        reportsToUsername: 'systems.analyst',
        employeeData: {
          firstName: 'Thomas',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1988-09-15'),
          gender: 'Male',
          nationalId: 'MWI016001005',
          email: 'business.analyst@sethnnections.mw',
          phoneNumber: '+265888000044',
          employmentDate: new Date('2021-04-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1078901234567',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 678, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40139',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Systems Administrator
      {
        username: 'systems.admin',
        email: 'systems.admin@sethnnections.mw',
        password: 'SysAdmin123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'IT',
        positionCode: 'SYS_ADMIN',
        gradeCode: 'M9',
        reportsToUsername: 'systems.analyst',
        employeeData: {
          firstName: 'Patricia',
          lastName: 'Msiska',
          dateOfBirth: new Date('1989-12-30'),
          gender: 'Female',
          nationalId: 'MWI016001006',
          email: 'systems.admin@sethnnections.mw',
          phoneNumber: '+265888000045',
          employmentDate: new Date('2021-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1089012345678',
          bankBranch: 'Area 2 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 789, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40140',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Database Administrator
      {
        username: 'database.admin',
        email: 'database.admin@sethnnections.mw',
        password: 'DBAdmin123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'IT',
        positionCode: 'DB_ADMIN',
        gradeCode: 'M8',
        reportsToUsername: 'systems.admin',
        employeeData: {
          firstName: 'Brian',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1991-07-15'),
          gender: 'Male',
          nationalId: 'MWI016001007',
          email: 'database.admin@sethnnections.mw',
          phoneNumber: '+265888000046',
          employmentDate: new Date('2022-02-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9079012345678',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 890, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40141',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Network Technician
      {
        username: 'network.technician',
        email: 'network.tech@sethnnections.mw',
        password: 'NetworkTech123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'IT',
        positionCode: 'NET_TECH',
        gradeCode: 'M7',
        reportsToUsername: 'systems.admin',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1992-04-25'),
          gender: 'Female',
          nationalId: 'MWI016001008',
          email: 'network.tech@sethnnections.mw',
          phoneNumber: '+265888000047',
          employmentDate: new Date('2022-05-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1090123456789',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 901, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40142',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Help Desk Technician
      {
        username: 'helpdesk.technician',
        email: 'helpdesk.tech@sethnnections.mw',
        password: 'HelpDesk123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'IT',
        positionCode: 'HELP_DESK',
        gradeCode: 'M6',
        reportsToUsername: 'systems.admin',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Mwale',
          dateOfBirth: new Date('1993-11-08'),
          gender: 'Male',
          nationalId: 'MWI016001009',
          email: 'helpdesk.tech@sethnnections.mw',
          phoneNumber: '+265888000048',
          employmentDate: new Date('2022-08-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1101234567890',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 012, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40143',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // IT Support Assistant
      {
        username: 'it.support.assistant',
        email: 'it.support@sethnnections.mw',
        password: 'ITSupport123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'IT',
        positionCode: 'IT_SUPPORT',
        gradeCode: 'M5',
        reportsToUsername: 'helpdesk.technician',
        employeeData: {
          firstName: 'Rachel',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1995-08-20'),
          gender: 'Female',
          nationalId: 'MWI016001010',
          email: 'it.support@sethnnections.mw',
          phoneNumber: '+265888000049',
          employmentDate: new Date('2023-02-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 720000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9080123456789',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 123, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40144',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(itEmployees);
  }

  // ==================== HR DEPARTMENT - COMPLETE ====================
  private async createHrDepartmentEmployees() {
    const hrEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'hr.director',
        email: 'hr.director@sethnnections.mw',
        password: 'HRDirector123!',
        role: UserRole.HR_MANAGER,
        departmentCode: 'HR',
        positionCode: 'HR_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Phiri',
          dateOfBirth: new Date('1979-07-20'),
          gender: 'Female',
          nationalId: 'MWI017001001',
          email: 'hr.director@sethnnections.mw',
          phoneNumber: '+265888000050',
          employmentDate: new Date('2020-01-20'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9013456789012',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 345, Area 8, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40145',
          systemRole: SystemRole.HR_MANAGER,
        },
      },
      // Chief Human Resources Officer
      {
        username: 'chief.hr.officer',
        email: 'chro@sethnnections.mw',
        password: 'CHRO123!',
        role: UserRole.HR_MANAGER,
        departmentCode: 'HR',
        positionCode: 'CHRO',
        gradeCode: 'M15',
        reportsToUsername: 'hr.director',
        employeeData: {
          firstName: 'Andrew',
          lastName: 'Kamoto',
          dateOfBirth: new Date('1981-11-15'),
          gender: 'Male',
          nationalId: 'MWI017001002',
          email: 'chro@sethnnections.mw',
          phoneNumber: '+265888000051',
          employmentDate: new Date('2020-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1114567890123',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM005',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 456, Area 6, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40146',
          systemRole: SystemRole.HR_MANAGER,
        },
      },
      // Senior HR Manager
      {
        username: 'senior.hr.manager',
        email: 'senior.hr.manager@sethnnections.mw',
        password: 'SeniorHR123!',
        role: UserRole.MANAGER,
        departmentCode: 'HR',
        positionCode: 'SEN_HR_MGR',
        gradeCode: 'M13',
        reportsToUsername: 'chief.hr.officer',
        employeeData: {
          firstName: 'Mary',
          lastName: 'Jere',
          dateOfBirth: new Date('1983-06-25'),
          gender: 'Female',
          nationalId: 'MWI017001003',
          email: 'senior.hr.manager@sethnnections.mw',
          phoneNumber: '+265888000052',
          employmentDate: new Date('2020-05-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9095678901234',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 567, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40147',
          systemRole: SystemRole.MANAGER,
        },
      },
      // HR Business Partner
      {
        username: 'hr.business.partner',
        email: 'hr.business.partner@sethnnections.mw',
        password: 'HRPartner123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'HR',
        positionCode: 'HR_BP',
        gradeCode: 'M11',
        reportsToUsername: 'senior.hr.manager',
        employeeData: {
          firstName: 'Thomas',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1985-09-12'),
          gender: 'Male',
          nationalId: 'MWI017001004',
          email: 'hr.business.partner@sethnnections.mw',
          phoneNumber: '+265888000053',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1125678901234',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 678, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40148',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Administration Manager
      {
        username: 'admin.manager',
        email: 'admin.manager@sethnnections.mw',
        password: 'AdminMgr123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'ADMIN_MGR',
        gradeCode: 'M10',
        reportsToUsername: 'hr.business.partner',
        employeeData: {
          firstName: 'Patricia',
          lastName: 'Msiska',
          dateOfBirth: new Date('1987-03-20'),
          gender: 'Female',
          nationalId: 'MWI017001005',
          email: 'admin.manager@sethnnections.mw',
          phoneNumber: '+265888000054',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9106789012345',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 789, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40149',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // HR Officer (Employee Relations)
      {
        username: 'hr.officer.er',
        email: 'hr.officer.er@sethnnections.mw',
        password: 'HROfficerER123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'HR',
        positionCode: 'HR_OFF_ER',
        gradeCode: 'M9',
        reportsToUsername: 'hr.business.partner',
        employeeData: {
          firstName: 'Brian',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1988-11-30'),
          gender: 'Male',
          nationalId: 'MWI017001006',
          email: 'hr.officer.er@sethnnections.mw',
          phoneNumber: '+265888000055',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1136789012345',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 890, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40150',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Training & Development Officer
      {
        username: 'training.development.officer',
        email: 'training.officer@sethnnections.mw',
        password: 'TrainingOff123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'TRAINING_OFF',
        gradeCode: 'M8',
        reportsToUsername: 'hr.officer.er',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1990-07-15'),
          gender: 'Female',
          nationalId: 'MWI017001007',
          email: 'training.officer@sethnnections.mw',
          phoneNumber: '+265888000056',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9117890123456',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 901, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40151',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Recruitment Officer
      {
        username: 'recruitment.officer',
        email: 'recruitment.officer@sethnnections.mw',
        password: 'Recruitment123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'RECRUIT_OFF',
        gradeCode: 'M7',
        reportsToUsername: 'hr.officer.er',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Mwale',
          dateOfBirth: new Date('1991-04-25'),
          gender: 'Male',
          nationalId: 'MWI017001008',
          email: 'recruitment.officer@sethnnections.mw',
          phoneNumber: '+265888000057',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1147890123456',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 012, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40152',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // HR Assistant
      {
        username: 'hr.assistant',
        email: 'hr.assistant@sethnnections.mw',
        password: 'HRAssistant123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'HR_ASST',
        gradeCode: 'M6',
        reportsToUsername: 'hr.officer.er',
        employeeData: {
          firstName: 'Rachel',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1993-10-08'),
          gender: 'Female',
          nationalId: 'MWI017001009',
          email: 'hr.assistant@sethnnections.mw',
          phoneNumber: '+265888000058',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1158901234567',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 123, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40153',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Receptionist
      {
        username: 'receptionist',
        email: 'receptionist@sethnnections.mw',
        password: 'Receptionist123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'RECEPTIONIST',
        gradeCode: 'M5',
        reportsToUsername: 'hr.assistant',
        employeeData: {
          firstName: 'James',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1994-12-20'),
          gender: 'Male',
          nationalId: 'MWI017001010',
          email: 'receptionist@sethnnections.mw',
          phoneNumber: '+265888000059',
          employmentDate: new Date('2023-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 720000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9128901234567',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 234, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40154',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Office Assistant
      {
        username: 'office.assistant',
        email: 'office.assistant@sethnnections.mw',
        password: 'OfficeAsst123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'HR',
        positionCode: 'OFFICE_ASST',
        gradeCode: 'M4',
        reportsToUsername: 'receptionist',
        employeeData: {
          firstName: 'Alice',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1996-05-20'),
          gender: 'Female',
          nationalId: 'MWI017001011',
          email: 'office.assistant@sethnnections.mw',
          phoneNumber: '+265888000060',
          employmentDate: new Date('2023-03-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 600000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1169012345678',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 345, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40155',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(hrEmployees);
  }

  // ==================== PROCUREMENT & SUPPLY CHAIN DEPARTMENT ====================
  private async createProcurementDepartmentEmployees() {
    const procurementEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'procurement.director',
        email: 'procurement.director@sethnnections.mw',
        password: 'ProcDirector123!',
        role: UserRole.DEPARTMENT_HEAD,
        departmentCode: 'PROC',
        positionCode: 'PROC_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.operations.officer',
        employeeData: {
          firstName: 'Richard',
          lastName: 'Kumwenda',
          dateOfBirth: new Date('1980-09-15'),
          gender: 'Male',
          nationalId: 'MWI018001001',
          email: 'procurement.director@sethnnections.mw',
          phoneNumber: '+265888000070',
          employmentDate: new Date('2020-02-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1170123456789',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN456789012',
          pensionNumber: 'MLPF456789',
          socialSecurityNumber: 'SSN456789',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 456, Area 11, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40160',
          systemRole: SystemRole.DEPARTMENT_HEAD,
        },
      },
      // Head of Supply Chain
      {
        username: 'head.supply.chain',
        email: 'head.supply.chain@sethnnections.mw',
        password: 'SupplyChain123!',
        role: UserRole.MANAGER,
        departmentCode: 'PROC',
        positionCode: 'HEAD_SUPPLY',
        gradeCode: 'M15',
        reportsToUsername: 'procurement.director',
        employeeData: {
          firstName: 'Grace',
          lastName: 'Phiri',
          dateOfBirth: new Date('1982-12-20'),
          gender: 'Female',
          nationalId: 'MWI018001002',
          email: 'head.supply.chain@sethnnections.mw',
          phoneNumber: '+265888000071',
          employmentDate: new Date('2020-04-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9131234567890',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 567, Area 7, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40161',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Procurement Manager
      {
        username: 'procurement.manager',
        email: 'procurement.manager@sethnnections.mw',
        password: 'ProcMgr123!',
        role: UserRole.MANAGER,
        departmentCode: 'PROC',
        positionCode: 'PROC_MGR',
        gradeCode: 'M13',
        reportsToUsername: 'head.supply.chain',
        employeeData: {
          firstName: 'Mike',
          lastName: 'Jere',
          dateOfBirth: new Date('1984-06-25'),
          gender: 'Male',
          nationalId: 'MWI018001003',
          email: 'procurement.manager@sethnnections.mw',
          phoneNumber: '+265888000072',
          employmentDate: new Date('2020-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1181234567890',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 678, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40162',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Supply Chain Analyst
      {
        username: 'supply.chain.analyst',
        email: 'supply.chain.analyst@sethnnections.mw',
        password: 'SupplyAnalyst123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'PROC',
        positionCode: 'SUPPLY_ANAL',
        gradeCode: 'M11',
        reportsToUsername: 'procurement.manager',
        employeeData: {
          firstName: 'Mary',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1986-03-15'),
          gender: 'Female',
          nationalId: 'MWI018001004',
          email: 'supply.chain.analyst@sethnnections.mw',
          phoneNumber: '+265888000073',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9142345678901',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 789, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40163',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Contracts Administrator
      {
        username: 'contracts.administrator',
        email: 'contracts.admin@sethnnections.mw',
        password: 'ContractsAdmin123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'PROC',
        positionCode: 'CONTRACTS_ADMIN',
        gradeCode: 'M10',
        reportsToUsername: 'supply.chain.analyst',
        employeeData: {
          firstName: 'Thomas',
          lastName: 'Msiska',
          dateOfBirth: new Date('1988-09-20'),
          gender: 'Male',
          nationalId: 'MWI018001005',
          email: 'contracts.admin@sethnnections.mw',
          phoneNumber: '+265888000074',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1192345678901',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 890, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40164',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Procurement Officer
      {
        username: 'procurement.officer',
        email: 'procurement.officer@sethnnections.mw',
        password: 'ProcOfficer123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'PROC',
        positionCode: 'PROC_OFF',
        gradeCode: 'M9',
        reportsToUsername: 'supply.chain.analyst',
        employeeData: {
          firstName: 'Patricia',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1989-12-30'),
          gender: 'Female',
          nationalId: 'MWI018001006',
          email: 'procurement.officer@sethnnections.mw',
          phoneNumber: '+265888000075',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1203456789012',
          bankBranch: 'Area 2 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 901, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40165',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Buyer
      {
        username: 'buyer1',
        email: 'buyer1@sethnnections.mw',
        password: 'Buyer123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'PROC',
        positionCode: 'BUYER',
        gradeCode: 'M8',
        reportsToUsername: 'procurement.officer',
        employeeData: {
          firstName: 'Brian',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1991-07-15'),
          gender: 'Male',
          nationalId: 'MWI018001007',
          email: 'buyer1@sethnnections.mw',
          phoneNumber: '+265888000076',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9153456789012',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 012, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40166',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Procurement Assistant
      {
        username: 'procurement.assistant',
        email: 'procurement.assistant@sethnnections.mw',
        password: 'ProcAsst123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'PROC',
        positionCode: 'PROC_ASST',
        gradeCode: 'M7',
        reportsToUsername: 'procurement.officer',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Mwale',
          dateOfBirth: new Date('1992-04-25'),
          gender: 'Female',
          nationalId: 'MWI018001008',
          email: 'procurement.assistant@sethnnections.mw',
          phoneNumber: '+265888000077',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1214567890123',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 123, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40167',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Inventory Clerk
      {
        username: 'inventory.clerk',
        email: 'inventory.clerk@sethnnections.mw',
        password: 'InventoryClerk123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'PROC',
        positionCode: 'INV_CLERK',
        gradeCode: 'M6',
        reportsToUsername: 'procurement.officer',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1993-11-08'),
          gender: 'Male',
          nationalId: 'MWI018001009',
          email: 'inventory.clerk@sethnnections.mw',
          phoneNumber: '+265888000078',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1225678901234',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 234, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40168',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Stores Assistant
      {
        username: 'stores.assistant',
        email: 'stores.assistant@sethnnections.mw',
        password: 'StoresAsst123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'PROC',
        positionCode: 'STORES_ASST',
        gradeCode: 'M4',
        reportsToUsername: 'inventory.clerk',
        employeeData: {
          firstName: 'Rachel',
          lastName: 'Phiri',
          dateOfBirth: new Date('1995-08-20'),
          gender: 'Female',
          nationalId: 'MWI018001010',
          email: 'stores.assistant@sethnnections.mw',
          phoneNumber: '+265888000079',
          employmentDate: new Date('2023-02-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.CONTRACT,
          currentBasicSalary: 600000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9164567890123',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 345, Area 22, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40169',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(procurementEmployees);
  }

  // ==================== LEGAL & COMPLIANCE DEPARTMENT ====================
  private async createLegalDepartmentEmployees() {
    const legalEmployees: EmployeeHierarchyData[] = [
      // Director Level
      {
        username: 'legal.director',
        email: 'legal.director@sethnnections.mw',
        password: 'LegalDirector123!',
        role: UserRole.DEPARTMENT_HEAD,
        departmentCode: 'LEGAL',
        positionCode: 'LEGAL_DIR',
        gradeCode: 'M17',
        reportsToUsername: 'chief.executive.officer',
        employeeData: {
          firstName: 'Emily',
          lastName: 'Banda',
          dateOfBirth: new Date('1978-04-20'),
          gender: 'Female',
          nationalId: 'MWI019001001',
          email: 'legal.director@sethnnections.mw',
          phoneNumber: '+265888000080',
          employmentDate: new Date('2020-01-20'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 6000000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1236789012345',
          bankBranch: 'City Centre Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN567890123',
          pensionNumber: 'MLPF567890',
          socialSecurityNumber: 'SSN567890',
          maritalStatus: 'married',
          numberOfDependents: 3,
          address: 'Plot 567, Area 8, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40170',
          systemRole: SystemRole.DEPARTMENT_HEAD,
        },
      },
      // General Counsel
      {
        username: 'general.counsel',
        email: 'general.counsel@sethnnections.mw',
        password: 'GeneralCounsel123!',
        role: UserRole.MANAGER,
        departmentCode: 'LEGAL',
        positionCode: 'GEN_COUNSEL',
        gradeCode: 'M15',
        reportsToUsername: 'legal.director',
        employeeData: {
          firstName: 'Andrew',
          lastName: 'Kumwenda',
          dateOfBirth: new Date('1980-11-15'),
          gender: 'Male',
          nationalId: 'MWI019001002',
          email: 'general.counsel@sethnnections.mw',
          phoneNumber: '+265888000081',
          employmentDate: new Date('2020-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 4500000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9175678901234',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN678901234',
          pensionNumber: 'MLPF678901',
          socialSecurityNumber: 'SSN678901',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 678, Area 6, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40171',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Chief Legal Counsel
      {
        username: 'chief.legal.counsel',
        email: 'chief.legal.counsel@sethnnections.mw',
        password: 'ChiefLegal123!',
        role: UserRole.MANAGER,
        departmentCode: 'LEGAL',
        positionCode: 'CHIEF_LEGAL',
        gradeCode: 'M13',
        reportsToUsername: 'general.counsel',
        employeeData: {
          firstName: 'Mary',
          lastName: 'Jere',
          dateOfBirth: new Date('1982-06-25'),
          gender: 'Female',
          nationalId: 'MWI019001003',
          email: 'chief.legal.counsel@sethnnections.mw',
          phoneNumber: '+265888000082',
          employmentDate: new Date('2020-05-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1247890123456',
          bankBranch: 'Area 3 Branch',
          bankBranchCode: 'NBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN789012345',
          pensionNumber: 'MLPF789012',
          socialSecurityNumber: 'SSN789012',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 789, Area 10, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40172',
          systemRole: SystemRole.MANAGER,
        },
      },
      // Senior Legal Counsel
      {
        username: 'senior.legal.counsel',
        email: 'senior.legal.counsel@sethnnections.mw',
        password: 'SeniorLegal123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'LEGAL',
        positionCode: 'SEN_LEGAL',
        gradeCode: 'M11',
        reportsToUsername: 'chief.legal.counsel',
        employeeData: {
          firstName: 'Thomas',
          lastName: 'Gondwe',
          dateOfBirth: new Date('1984-09-12'),
          gender: 'Male',
          nationalId: 'MWI019001004',
          email: 'senior.legal.counsel@sethnnections.mw',
          phoneNumber: '+265888000083',
          employmentDate: new Date('2021-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 3000000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9186789012345',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN890123456',
          pensionNumber: 'MLPF890123',
          socialSecurityNumber: 'SSN890123',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 890, Area 15, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40173',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Regulatory Affairs Manager
      {
        username: 'regulatory.affairs.manager',
        email: 'regulatory.manager@sethnnections.mw',
        password: 'Regulatory123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'LEGAL',
        positionCode: 'REG_AFFAIRS_MGR',
        gradeCode: 'M10',
        reportsToUsername: 'senior.legal.counsel',
        employeeData: {
          firstName: 'Patricia',
          lastName: 'Msiska',
          dateOfBirth: new Date('1986-03-20'),
          gender: 'Female',
          nationalId: 'MWI019001005',
          email: 'regulatory.manager@sethnnections.mw',
          phoneNumber: '+265888000084',
          employmentDate: new Date('2021-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 2400000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1258901234567',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN901234567',
          pensionNumber: 'MLPF901234',
          socialSecurityNumber: 'SSN901234',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 901, Area 25, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40174',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Legal Officer
      {
        username: 'legal.officer',
        email: 'legal.officer@sethnnections.mw',
        password: 'LegalOfficer123!',
        role: UserRole.SUPERVISOR,
        departmentCode: 'LEGAL',
        positionCode: 'LEGAL_OFF',
        gradeCode: 'M9',
        reportsToUsername: 'senior.legal.counsel',
        employeeData: {
          firstName: 'Brian',
          lastName: 'Mbewe',
          dateOfBirth: new Date('1987-11-30'),
          gender: 'Male',
          nationalId: 'MWI019001006',
          email: 'legal.officer@sethnnections.mw',
          phoneNumber: '+265888000085',
          employmentDate: new Date('2021-06-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1800000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1269012345678',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM002',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN012345678',
          pensionNumber: 'MLPF012345',
          socialSecurityNumber: 'SSN012345',
          maritalStatus: 'married',
          numberOfDependents: 2,
          address: 'Plot 012, Area 12, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40175',
          systemRole: SystemRole.SUPERVISOR,
        },
      },
      // Contracts Officer
      {
        username: 'contracts.officer',
        email: 'contracts.officer@sethnnections.mw',
        password: 'ContractsOff123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'LEGAL',
        positionCode: 'CONTRACTS_OFF',
        gradeCode: 'M8',
        reportsToUsername: 'legal.officer',
        employeeData: {
          firstName: 'Susan',
          lastName: 'Kachingwe',
          dateOfBirth: new Date('1989-07-15'),
          gender: 'Female',
          nationalId: 'MWI019001007',
          email: 'contracts.officer@sethnnections.mw',
          phoneNumber: '+265888000086',
          employmentDate: new Date('2022-01-15'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1450000,
          bankName: 'Standard Bank Malawi',
          bankAccountNumber: '9197890123456',
          bankBranch: 'Lilongwe Main',
          bankBranchCode: 'SBM001',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN123456789',
          pensionNumber: 'MLPF123456',
          socialSecurityNumber: 'SSN123456',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 123, Area 36, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40176',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Compliance Officer
      {
        username: 'compliance.officer',
        email: 'compliance.officer@sethnnections.mw',
        password: 'Compliance123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'LEGAL',
        positionCode: 'COMPLIANCE_OFF',
        gradeCode: 'M7',
        reportsToUsername: 'legal.officer',
        employeeData: {
          firstName: 'Daniel',
          lastName: 'Mwale',
          dateOfBirth: new Date('1990-04-25'),
          gender: 'Male',
          nationalId: 'MWI019001008',
          email: 'compliance.officer@sethnnections.mw',
          phoneNumber: '+265888000087',
          employmentDate: new Date('2022-03-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 1100000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1270123456789',
          bankBranch: 'Area 18 Branch',
          bankBranchCode: 'NBM004',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN234567890',
          pensionNumber: 'MLPF234567',
          socialSecurityNumber: 'SSN234567',
          maritalStatus: 'married',
          numberOfDependents: 1,
          address: 'Plot 234, Area 33, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40177',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
      // Legal Assistant
      {
        username: 'legal.assistant',
        email: 'legal.assistant@sethnnections.mw',
        password: 'LegalAsst123!',
        role: UserRole.EMPLOYEE,
        departmentCode: 'LEGAL',
        positionCode: 'LEGAL_ASST',
        gradeCode: 'M6',
        reportsToUsername: 'legal.officer',
        employeeData: {
          firstName: 'Rachel',
          lastName: 'Nkhoma',
          dateOfBirth: new Date('1992-10-08'),
          gender: 'Female',
          nationalId: 'MWI019001009',
          email: 'legal.assistant@sethnnections.mw',
          phoneNumber: '+265888000088',
          employmentDate: new Date('2022-07-01'),
          employmentStatus: EmploymentStatus.ACTIVE,
          contractType: ContractType.PERMANENT,
          currentBasicSalary: 850000,
          bankName: 'National Bank of Malawi',
          bankAccountNumber: '1281234567890',
          bankBranch: 'Kawale Branch',
          bankBranchCode: 'NBM003',
          currency: 'MWK',
          taxIdentificationNumber: 'TPIN345678901',
          pensionNumber: 'MLPF345678',
          socialSecurityNumber: 'SSN345678',
          maritalStatus: 'single',
          numberOfDependents: 0,
          address: 'Plot 345, Area 49, Lilongwe',
          city: 'Lilongwe',
          country: 'Malawi',
          postalCode: 'P.O. Box 40178',
          systemRole: SystemRole.EMPLOYEE,
        },
      },
    ];

    await this.createEmployeeBatch(legalEmployees);
  }

  // Update the createEmployeeBatch method in organization-seeder.service.ts

  private async createEmployeeBatch(employees: EmployeeHierarchyData[]) {
    for (const employeeData of employees) {
      try {
        // Check if user already exists
        const existingUser = await this.userModel.findOne({
          $or: [
            { username: employeeData.username },
            { email: employeeData.email },
          ],
        });

        if (existingUser) {
          this.logger.log(
            `User ${employeeData.username} already exists, skipping...`,
          );
          this.userMap.set(
            employeeData.username,
            this.safeGetObjectId(existingUser._id),
          );
          continue;
        }

        // Get department, position, and grade first
        const department = await this.departmentModel.findOne({
          departmentCode: employeeData.departmentCode,
        });
        if (!department) {
          this.logger.warn(
            `Department not found: ${employeeData.departmentCode} for user ${employeeData.username}`,
          );
          continue;
        }

        const position = await this.positionModel.findOne({
          positionCode: employeeData.positionCode,
        });
        if (!position) {
          this.logger.warn(
            `Position not found: ${employeeData.positionCode} for user ${employeeData.username}`,
          );
          continue;
        }

        const grade = await this.gradeModel.findOne({
          code: employeeData.gradeCode,
        });
        if (!grade) {
          this.logger.warn(
            `Grade not found: ${employeeData.gradeCode} for user ${employeeData.username}`,
          );
          continue;
        }

        // Get reportsTo employee if specified
        let reportsToEmployeeId: Types.ObjectId | undefined;
        let reportsToEmployeeNumber: string | undefined;

        if (employeeData.reportsToUsername) {
          const reportsToEmployee = await this.employeeModel
            .findOne({
              $or: [
                { _id: this.employeeMap.get(employeeData.reportsToUsername) },
                { systemUsername: employeeData.reportsToUsername },
              ],
            })
            .populate('gradeId'); // POPULATE GRADE

          if (reportsToEmployee) {
            reportsToEmployeeId = this.safeGetObjectId(reportsToEmployee._id);
            reportsToEmployeeNumber = reportsToEmployee.employeeNumber;
            // Remove reportsToGradeCode since we deleted the field
          }
        }

        // Generate employee number
        const employeeNumber =
          await this.employeeNumberService.generateEmployeeNumber(
            department.id.toString(),
          );

        // Determine supervisor flags based on grade - USE GRADE.CODE
        const SUPERVISOR_GRADES = [
          'M9',
          'M10',
          'M11',
          'M13',
          'M15',
          'M17',
          'CEO',
        ];
        const DEPARTMENT_MANAGER_GRADES = ['M17', 'CEO'];

        const isSupervisor = SUPERVISOR_GRADES.includes(grade.code); // Use grade.code
        const isDepartmentManager = DEPARTMENT_MANAGER_GRADES.includes(
          grade.code,
        ); // Use grade.code

        // Create employee first (without userId) - REMOVE DENORMALIZED GRADE FIELDS
        const employee = await this.employeeModel.create({
          employeeNumber,
          ...employeeData.employeeData,
          departmentId: department._id,
          positionId: position._id,
          gradeId: grade._id,
          // REMOVE: gradeCode, gradeBand, gradeLevel
          reportsToEmployeeId,
          reportsToEmployeeNumber, // Keep only employee number
          // REMOVE: reportsToGradeCode
          currentBasicSalary: grade.compensation.basicSalary.mid,
          houseAllowance: grade.compensation.houseAllowance,
          carAllowance: grade.compensation.carAllowance,
          travelAllowance: grade.compensation.travelAllowance,
          overtimeRate: grade.compensation.overtimeRate,
          maxLoanAmount: grade.limits.maxLoanAmount,
          maxApprovalLevel: grade.limits.maxApprovalLevel,
          requiresManagerApproval: grade.limits.requiresManagerApproval,
          requiresDirectorApproval: grade.limits.requiresDirectorApproval,
          // Properly set supervisor flags
          isSupervisor,
          isDepartmentManager,
          systemRole:
            employeeData.employeeData.systemRole || SystemRole.EMPLOYEE,
          hasSystemAccess: true,
          systemUsername: employeeData.username,
          createdBy: 'system',
        });

        const employeeId = this.safeGetObjectId(employee._id);
        this.employeeMap.set(employeeData.username, employeeId);

        // Hash password and create user
        const hashedPassword = await bcrypt.hash(employeeData.password, 10);

        // Create user with employeeId reference
        const user = await this.userModel.create({
          username: employeeData.username,
          email: employeeData.email,
          password: hashedPassword,
          role: employeeData.role,
          employeeId: employeeId,
          loginMethod: LoginMethod.EMAIL,
          status: UserStatus.ACTIVE,
          lastLoginAt: null,
          failedLoginAttempts: 0,
          passwordChangedAt: new Date(),
          emailVerified: true,
          createdBy: 'system',
        });

        const userId = this.safeGetObjectId(user._id);
        this.userMap.set(employeeData.username, userId);

        // Update employee with userId (if your Employee schema has userId field)
        try {
          await this.employeeModel.findByIdAndUpdate(employeeId, {
            userId: userId,
          });
        } catch {
          // If userId field doesn't exist in Employee schema, just log and continue
          this.logger.log(
            `Note: Employee schema doesn't have userId field for ${employeeData.username}`,
          );
        }

        const supervisorStatus = isSupervisor ? 'SUPERVISOR' : ' Employee';
        const managerStatus = isDepartmentManager ? ' | DEPT MANAGER' : '';

        this.logger.log(
          ` Created: ${employeeData.username} (${grade.code}) ${supervisorStatus}${managerStatus} - Reports to: ${employeeData.reportsToUsername || 'CEO'}`,
        );
      } catch (error) {
        this.logger.error(
          ` Error creating employee ${employeeData.username}:`,
          error,
        );
      }
    }
  }

  // Add a helper method to verify supervisor hierarchy
  async verifySupervisorHierarchy() {
    this.logger.log(' Verifying supervisor hierarchy...');

    const allEmployees = await this.employeeModel
      .find()
      .populate('gradeId')
      .populate('reportsToEmployeeId')
      .sort({ 'gradeId.level': -1 }); // Sort by grade level instead of gradeCode

    const supervisors = allEmployees.filter((emp) => emp.isSupervisor);
    const departmentManagers = allEmployees.filter(
      (emp) => emp.isDepartmentManager,
    );

    this.logger.log(`\n Hierarchy Summary:`);
    this.logger.log(`   Total Employees: ${allEmployees.length}`);
    this.logger.log(`   Supervisors: ${supervisors.length}`);
    this.logger.log(`   Department Managers: ${departmentManagers.length}`);

    this.logger.log(`\nSupervisors by Grade:`);
    const supervisorsByGrade = supervisors.reduce(
      (acc, emp) => {
        const gradeCode = (emp.gradeId as any)?.code || 'UNKNOWN'; // Access via populated gradeId
        acc[gradeCode] = (acc[gradeCode] || 0) + 1;
        return acc;
      },
      {} as Record<string, number>,
    );

    Object.entries(supervisorsByGrade)
      .sort(([a], [b]) => b.localeCompare(a))
      .forEach(([grade, count]) => {
        this.logger.log(`   ${grade}: ${count} supervisor(s)`);
      });

    // Verify reporting structure
    this.logger.log(`\n Verifying Reporting Structure:`);
    for (const supervisor of supervisors) {
      const directReports = await this.employeeModel.countDocuments({
        reportsToEmployeeId: supervisor._id,
      });

      if (directReports > 0) {
        const gradeCode = (supervisor.gradeId as any)?.code || 'UNKNOWN';
        this.logger.log(
          `   ${supervisor.firstName} ${supervisor.lastName} (${gradeCode}): ${directReports} direct report(s)`,
        );
      }
    }

    return {
      totalEmployees: allEmployees.length,
      totalSupervisors: supervisors.length,
      totalDepartmentManagers: departmentManagers.length,
      supervisorsByGrade,
    };
  }

  // Update the main seeder method to include verification
  async createCompleteEmployeeHierarchy() {
    this.logger.log('Creating complete employee hierarchy...');

    try {
      // Check if employees already exist
      const existingEmployees = await this.employeeModel.countDocuments();
      if (existingEmployees > 50) {
        this.logger.log('Employee hierarchy already exists. Skipping...');
        return;
      }

      await this.createExecutiveManagement();
      await this.createTechnicalDepartmentEmployees();
      await this.createCommercialDepartmentEmployees();
      await this.createFinanceDepartmentEmployees();
      await this.createItDepartmentEmployees();
      await this.createHrDepartmentEmployees();
      await this.createProcurementDepartmentEmployees();
      await this.createLegalDepartmentEmployees();

      this.logger.log('\n Complete employee hierarchy created successfully!');
      this.logger.log(` Total users created: ${this.userMap.size}`);
      this.logger.log(`Total employees created: ${this.employeeMap.size}`);

      // Verify the supervisor hierarchy
      await this.verifySupervisorHierarchy();
    } catch (error) {
      this.logger.error('Error creating employee hierarchy:', error);
      throw error;
    }
  }
  // Additional methods for workflow management...
  async getEmployeeHierarchy(employeeId: string) {
    const employee = await this.employeeModel
      .findById(employeeId)
      .populate('reportsToEmployeeId')
      .populate('departmentId')
      .populate('positionId')
      .populate('gradeId')
      .exec();

    if (!employee) {
      throw new Error('Employee not found');
    }

    // Get direct reports
    const directReports = await this.employeeModel
      .find({
        reportsToEmployeeId: employeeId,
      })
      .populate('gradeId')
      .exec();

    // Get reporting chain (all supervisors up to CEO)
    const reportingChain = await this.getReportingChain(employeeId);

    return {
      employee,
      directReports,
      reportingChain,
      hierarchyLevel: await this.calculateHierarchyLevel(employeeId),
    };
  }

  private async getReportingChain(employeeId: string): Promise<any[]> {
    const chain: any[] = [];
    let currentEmployeeId: Types.ObjectId | null = new Types.ObjectId(
      employeeId,
    );

    while (currentEmployeeId) {
      const employee = await this.employeeModel
        .findById(currentEmployeeId)
        .populate('reportsToEmployeeId')
        .populate('gradeId')
        .exec();

      if (!employee) break;

      const gradeCode = (employee.gradeId as any)?.code || 'UNKNOWN';

      chain.push({
        _id: employee._id,
        employeeNumber: employee.employeeNumber,
        fullName: `${employee.firstName} ${employee.lastName}`,
        gradeCode: gradeCode, // Now from populated gradeId
        position: employee.positionId,
        reportsTo: employee.reportsToEmployeeId,
      });

      currentEmployeeId = employee.reportsToEmployeeId || null;
    }

    return chain;
  }

  private async calculateHierarchyLevel(employeeId: string): Promise<number> {
    let level = 0;
    let currentEmployeeId: Types.ObjectId | null = new Types.ObjectId(
      employeeId,
    );

    while (currentEmployeeId) {
      const employee = await this.employeeModel.findById(currentEmployeeId);
      if (!employee || !employee.reportsToEmployeeId) break;

      level++;
      currentEmployeeId = employee.reportsToEmployeeId;
    }

    return level;
  }
}
